<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>gulp | Ertsul&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://s2.loli.net/2022/04/02/uCOBfH6XgGUEdPt.png">
    <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://s2.loli.net/2022/04/02/uCOBfH6XgGUEdPt.png">
    <style type="text/css">.logo {height: 2.2rem!important; width: 2.2rem!important;border-radius: 100%;margin-right: 0.8rem;vertical-align: top;}</style>
    <meta name="description" content="è®°å½•æ‰€å­¦">
    
    <link rel="preload" href="/blog/assets/css/0.styles.214aaa3c.css" as="style"><link rel="preload" href="/blog/assets/js/app.6db985fd.js" as="script"><link rel="preload" href="/blog/assets/js/2.9a122aa2.js" as="script"><link rel="preload" href="/blog/assets/js/41.32f10a8a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.bac3eb3a.js"><link rel="prefetch" href="/blog/assets/js/11.8692c733.js"><link rel="prefetch" href="/blog/assets/js/12.f93aed8a.js"><link rel="prefetch" href="/blog/assets/js/13.a123951d.js"><link rel="prefetch" href="/blog/assets/js/14.ae1839d3.js"><link rel="prefetch" href="/blog/assets/js/15.5e07c399.js"><link rel="prefetch" href="/blog/assets/js/16.7cfea898.js"><link rel="prefetch" href="/blog/assets/js/17.4ca6c8ce.js"><link rel="prefetch" href="/blog/assets/js/18.ccdff12f.js"><link rel="prefetch" href="/blog/assets/js/19.3e8c1350.js"><link rel="prefetch" href="/blog/assets/js/20.4c81610b.js"><link rel="prefetch" href="/blog/assets/js/21.e9d50552.js"><link rel="prefetch" href="/blog/assets/js/22.0aa22e7b.js"><link rel="prefetch" href="/blog/assets/js/23.f0dea7dc.js"><link rel="prefetch" href="/blog/assets/js/24.fb6a0cea.js"><link rel="prefetch" href="/blog/assets/js/25.47b5985f.js"><link rel="prefetch" href="/blog/assets/js/26.4f8f8ad0.js"><link rel="prefetch" href="/blog/assets/js/27.2c78cdfa.js"><link rel="prefetch" href="/blog/assets/js/28.a67a65b3.js"><link rel="prefetch" href="/blog/assets/js/29.12b723c5.js"><link rel="prefetch" href="/blog/assets/js/3.9f36e379.js"><link rel="prefetch" href="/blog/assets/js/30.71deaaf3.js"><link rel="prefetch" href="/blog/assets/js/31.1ec7fe1d.js"><link rel="prefetch" href="/blog/assets/js/32.50f872a7.js"><link rel="prefetch" href="/blog/assets/js/33.122bf118.js"><link rel="prefetch" href="/blog/assets/js/34.ce2d415a.js"><link rel="prefetch" href="/blog/assets/js/35.e0c2b324.js"><link rel="prefetch" href="/blog/assets/js/36.2d292291.js"><link rel="prefetch" href="/blog/assets/js/37.3256fe3a.js"><link rel="prefetch" href="/blog/assets/js/38.9fe45f49.js"><link rel="prefetch" href="/blog/assets/js/39.2e625ccd.js"><link rel="prefetch" href="/blog/assets/js/4.b7f2959e.js"><link rel="prefetch" href="/blog/assets/js/40.dcf091f2.js"><link rel="prefetch" href="/blog/assets/js/42.e1a986bc.js"><link rel="prefetch" href="/blog/assets/js/43.e2ba3234.js"><link rel="prefetch" href="/blog/assets/js/44.bce0fe5d.js"><link rel="prefetch" href="/blog/assets/js/45.a0487ea2.js"><link rel="prefetch" href="/blog/assets/js/46.e4ff466e.js"><link rel="prefetch" href="/blog/assets/js/47.e144939f.js"><link rel="prefetch" href="/blog/assets/js/48.07fa9e8d.js"><link rel="prefetch" href="/blog/assets/js/49.2b3da980.js"><link rel="prefetch" href="/blog/assets/js/5.d2ed3c3b.js"><link rel="prefetch" href="/blog/assets/js/50.35019b81.js"><link rel="prefetch" href="/blog/assets/js/51.ac7b5ca2.js"><link rel="prefetch" href="/blog/assets/js/52.b4fe6184.js"><link rel="prefetch" href="/blog/assets/js/53.23741016.js"><link rel="prefetch" href="/blog/assets/js/54.6dfca452.js"><link rel="prefetch" href="/blog/assets/js/55.14e5add3.js"><link rel="prefetch" href="/blog/assets/js/56.3477d46d.js"><link rel="prefetch" href="/blog/assets/js/57.1cd7bcc6.js"><link rel="prefetch" href="/blog/assets/js/58.f2df43ee.js"><link rel="prefetch" href="/blog/assets/js/59.6721178f.js"><link rel="prefetch" href="/blog/assets/js/6.44c6ca6e.js"><link rel="prefetch" href="/blog/assets/js/60.9818715f.js"><link rel="prefetch" href="/blog/assets/js/61.2de98661.js"><link rel="prefetch" href="/blog/assets/js/7.47d07dcc.js"><link rel="prefetch" href="/blog/assets/js/8.5b878acb.js"><link rel="prefetch" href="/blog/assets/js/9.edfd3b4d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.214aaa3c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="https://s2.loli.net/2022/04/12/T3dGOP1mI9BZMRw.jpg" alt="Ertsul's Blog" class="logo"> <span class="site-name can-hide">Ertsul's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åˆ†ç±»" class="dropdown-title"><span class="title">åˆ†ç±»</span> <span class="arrow down"></span></button> <button type="button" aria-label="åˆ†ç±»" class="mobile-dropdown-title"><span class="title">åˆ†ç±»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/vue-source-code/Vue æºç é˜…è¯»1 å¼•å…¥vueæ¨¡å—/" class="nav-link">
  Vue æºç 
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue-router/vue-router æºç é˜…è¯»ï¼ˆä¸€ï¼‰/" class="nav-link">
  vue-router æºç 
</a></li><li class="dropdown-item"><!----> <a href="/blog/vuex/vuex æºç é˜…è¯»/" class="nav-link">
  vuex æºç é˜…è¯»
</a></li><li class="dropdown-item"><!----> <a href="/blog/question-source-code/vue-template-compiler template ç¼–è¯‘æµç¨‹/" class="nav-link">
  å¸¦ç€é—®é¢˜çœ‹æºç 
</a></li><li class="dropdown-item"><!----> <a href="/blog/router/å‰ç«¯è·¯ç”±/" class="nav-link">
  å‰ç«¯è·¯ç”±
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/svg sprite/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue-ssr/vue-srr é¡¹ç›®æ­å»º/" class="nav-link">
  Vue SSR
</a></li><li class="dropdown-item"><!----> <a href="/blog/javascript/EC AO VO Scope Chain/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/blog/flutter/flutter çŸ¥è¯†ç‚¹è®°å½•/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><!----> <a href="/blog/webpack/webpackå­¦ä¹ ç¬”è®°/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/blog/low-code-platform/å¯è§†åŒ–æ­å»ºå¹³å°ï¼ˆä¸€ï¼‰- æµç¨‹/" class="nav-link">
  å¯è§†åŒ–æ­å»ºå¹³å°
</a></li><li class="dropdown-item"><!----> <a href="/blog/algorithm/å¹¿åº¦ä¼˜å…ˆæœç´¢ BFS å’Œæ·±åº¦ä¼˜å…ˆæœç´¢ DFS/" class="nav-link">
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/blog/css/3Dç«‹ä½“éª°å­/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/blog/git/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/web-safe/web-safe/" class="nav-link">
  Web Safe
</a></li><li class="dropdown-item"><!----> <a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–/" class="nav-link">
  å°ç¨‹åº
</a></li><li class="dropdown-item"><!----> <a href="/blog/others/v8 å¼•æ“åŠå…¶ GC æœºåˆ¶/" class="nav-link">
  å…¶ä»–
</a></li></ul></div></div><div class="nav-item"><a href="/blog/" class="nav-link">
  ä¸»é¡µ
</a></div> <a href="https://github.com/Ertsul/" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åˆ†ç±»" class="dropdown-title"><span class="title">åˆ†ç±»</span> <span class="arrow down"></span></button> <button type="button" aria-label="åˆ†ç±»" class="mobile-dropdown-title"><span class="title">åˆ†ç±»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/vue-source-code/Vue æºç é˜…è¯»1 å¼•å…¥vueæ¨¡å—/" class="nav-link">
  Vue æºç 
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue-router/vue-router æºç é˜…è¯»ï¼ˆä¸€ï¼‰/" class="nav-link">
  vue-router æºç 
</a></li><li class="dropdown-item"><!----> <a href="/blog/vuex/vuex æºç é˜…è¯»/" class="nav-link">
  vuex æºç é˜…è¯»
</a></li><li class="dropdown-item"><!----> <a href="/blog/question-source-code/vue-template-compiler template ç¼–è¯‘æµç¨‹/" class="nav-link">
  å¸¦ç€é—®é¢˜çœ‹æºç 
</a></li><li class="dropdown-item"><!----> <a href="/blog/router/å‰ç«¯è·¯ç”±/" class="nav-link">
  å‰ç«¯è·¯ç”±
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/svg sprite/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue-ssr/vue-srr é¡¹ç›®æ­å»º/" class="nav-link">
  Vue SSR
</a></li><li class="dropdown-item"><!----> <a href="/blog/javascript/EC AO VO Scope Chain/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/blog/flutter/flutter çŸ¥è¯†ç‚¹è®°å½•/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><!----> <a href="/blog/webpack/webpackå­¦ä¹ ç¬”è®°/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/blog/low-code-platform/å¯è§†åŒ–æ­å»ºå¹³å°ï¼ˆä¸€ï¼‰- æµç¨‹/" class="nav-link">
  å¯è§†åŒ–æ­å»ºå¹³å°
</a></li><li class="dropdown-item"><!----> <a href="/blog/algorithm/å¹¿åº¦ä¼˜å…ˆæœç´¢ BFS å’Œæ·±åº¦ä¼˜å…ˆæœç´¢ DFS/" class="nav-link">
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/blog/css/3Dç«‹ä½“éª°å­/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/blog/git/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/web-safe/web-safe/" class="nav-link">
  Web Safe
</a></li><li class="dropdown-item"><!----> <a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–/" class="nav-link">
  å°ç¨‹åº
</a></li><li class="dropdown-item"><!----> <a href="/blog/others/v8 å¼•æ“åŠå…¶ GC æœºåˆ¶/" class="nav-link">
  å…¶ä»–
</a></li></ul></div></div><div class="nav-item"><a href="/blog/" class="nav-link">
  ä¸»é¡µ
</a></div> <a href="https://github.com/Ertsul/" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–.html" class="active sidebar-link">å°ç¨‹åºå·¥ç¨‹åŒ–</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–.html#gulp" class="sidebar-link">gulp</a></li><li class="sidebar-sub-header"><a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–.html#gulp-ç¼–è¯‘é¡¹ç›®" class="sidebar-link">gulp ç¼–è¯‘é¡¹ç›®</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–.html#é¡¹ç›®ç»“æ„" class="sidebar-link">é¡¹ç›®ç»“æ„</a></li><li class="sidebar-sub-header"><a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–.html#gulp-é…ç½®æ–‡ä»¶-baseconfig-js" class="sidebar-link">gulp é…ç½®æ–‡ä»¶ baseConfig.js</a></li><li class="sidebar-sub-header"><a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–.html#gulp-å¼€å‘æµç¨‹" class="sidebar-link">gulp å¼€å‘æµç¨‹</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–.html#è·¯ç”±å°è£…" class="sidebar-link">è·¯ç”±å°è£…</a></li><li class="sidebar-sub-header"><a href="/blog/minapp/å°ç¨‹åºå·¥ç¨‹åŒ–.html#http-å°è£…åŠå…¶æ¥å£ç»Ÿä¸€ç®¡ç†" class="sidebar-link">http å°è£…åŠå…¶æ¥å£ç»Ÿä¸€ç®¡ç†</a></li></ul></li><li><a href="/blog/minapp/å°ç¨‹åºæ–‡ä»¶ç”Ÿæˆè„šæœ¬.html" class="sidebar-link">å°ç¨‹åºæ–‡ä»¶ç”Ÿæˆè„šæœ¬</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="gulp"><a href="#gulp" class="header-anchor">#</a> <em>gulp</em></h2> <p><a href="https://www.gulpjs.com.cn/" target="_blank" rel="noopener noreferrer">ğŸ‘‰å®˜æ–¹æ–‡æ¡£ä¼ é€é—¨<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="gulp-ç¼–è¯‘é¡¹ç›®"><a href="#gulp-ç¼–è¯‘é¡¹ç›®" class="header-anchor">#</a> <em>gulp</em> ç¼–è¯‘é¡¹ç›®</h2> <p>æ—¥å¸¸è¿›è¡Œå°ç¨‹åºå¼€å‘ï¼Œé‡åˆ°çš„é—®é¢˜æœ‰ï¼š</p> <ul><li>å¦‚æœåœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·è¿›è¡Œå¼€å‘çš„è¯ï¼Œæ•ˆç‡ä½ï¼›</li> <li>ä¸æ”¯æŒ <em>less</em> cssé¢„ç¼–è¯‘å™¨ ï¼›</li> <li><em>autoprefixer</em> ï¼›</li> <li>...</li></ul> <p>è€ƒè™‘åˆ°å°ç¨‹åºæ˜¯å¤šé¡µé¢åº”ç”¨ï¼Œæˆ‘ä»¬åªè¦åœ¨ <em>src</em> ç›®å½•æ·»åŠ å°ç¨‹åºåˆå§‹åŒ–æ—¶æ‰€éœ€è¦çš„ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ <em>gulp</em> å°† <em>src</em> ä¸‹çš„ä»£ç æ¬ç§»åˆ° <em>dist</em> æ‰“åŒ…ç›®å½•å³å¯ã€‚</p> <h3 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="header-anchor">#</a> é¡¹ç›®ç»“æ„</h3> <div class="language- extra-class"><pre class="language-text"><code>â””â”€â”€â”€gulpTask ç›®å½•ï¼šä¸»è¦å­˜æ”¾ gulp ä»£ç é€»è¾‘
| 	â””â”€â”€â”€baseConfig.js // gulp è·¯å¾„å’Œ blob é…ç½®ä¿¡æ¯
| 	â””â”€â”€â”€clean.js // æ¸…ç† dist nodejs è„šæœ¬æ–‡ä»¶
| 	â””â”€â”€â”€taskControler.js // gulp ä»»åŠ¡å®šä¹‰
|â”€â”€â”€src
| 	â””â”€â”€â”€common // å…¬å…±ä»£ç 
| 		â””â”€â”€â”€less
| 			â””â”€â”€â”€...
| 		â””â”€â”€â”€js
| 			â””â”€â”€â”€...
| 	â””â”€â”€â”€components // ç»„ä»¶
| 			â””â”€â”€â”€...
| 	â””â”€â”€â”€pages // é¡µé¢
| 			â””â”€â”€â”€...
| 	â””â”€â”€â”€router // è·¯ç”±
| 			â””â”€â”€â”€router.js // è·¯ç”±å¤„ç†é€»è¾‘
| 			â””â”€â”€â”€routerPath.js // è·¯ç”±è¡¨
| 	â””â”€â”€â”€api // è¯·æ±‚æ•°æ®æ¥å£ç»Ÿä¸€å¤„ç†
| 			â””â”€â”€â”€api.js
| 	â””â”€â”€â”€http // http ç½‘ç»œè¯·æ±‚
| 			â””â”€â”€â”€baseConfig.js // åŸºæœ¬é…ç½®
| 			â””â”€â”€â”€devConfig.js // å¼€å‘åŸºæœ¬é…ç½®
| 			â””â”€â”€â”€prodConfig.js // ç”Ÿäº§åŸºæœ¬é…ç½®
| 			â””â”€â”€â”€request.js // è¯·æ±‚å¤„ç†é€»è¾‘
|	â””â”€â”€â”€app.js
|	â””â”€â”€â”€app.json
|	â””â”€â”€â”€project.config.json
|	â””â”€â”€â”€sitemap.json
â””â”€â”€â”€.eslintrc // eslint é…ç½®
â””â”€â”€â”€.gitignore // git é…ç½®
â””â”€â”€â”€gulpfile.js // gulp ä¸»å…¥å£
â””â”€â”€â”€package.json
â””â”€â”€â”€README.md
</code></pre></div><h3 id="gulp-é…ç½®æ–‡ä»¶-baseconfig-js"><a href="#gulp-é…ç½®æ–‡ä»¶-baseconfig-js" class="header-anchor">#</a> <em>gulp</em> é…ç½®æ–‡ä»¶ <em>baseConfig.js</em></h3> <p>å°† <em>gulp</em> ç›¸å…³è·¯å¾„å’Œ <em>blob</em> é…ç½®ä¿¡æ¯ç»Ÿä¸€åœ¨ <em>baseConfig.js</em> ä¸­è¿›è¡Œé…ç½®ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> srcPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> distPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isDev <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;--development&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  isDev<span class="token punctuation">,</span> <span class="token comment">// å½“å‰ç¯å¢ƒ</span>
  srcPath<span class="token punctuation">,</span> <span class="token comment">// src æºè·¯å¾„</span>
  distPath<span class="token punctuation">,</span> <span class="token comment">// dist ç¼–è¯‘ç›®æ ‡è·¯å¾„</span>
  <span class="token literal-property property">basePath</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    srcPath
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">otherPath</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    srcPath<span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/**/*.less</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/**/*.wxml</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/**/*.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/**/*.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/icons/*.jpg</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/icons/*.png</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/images/*.jpg</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/images/*.png</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">lessPath</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// less blob</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/**/*.less</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">jsPath</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// js blob</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/**/*.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">wxmlPath</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// wxml blob</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/**/*.wxml</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">jsonPath</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// json blob</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/**/*.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">lessImportPath</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/common/less/*.less</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">iconPath</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/icons/*.jpg</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/icons/*.png</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">imagePath</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/images/*.jpg</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/images/*.gif</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/static/images/*.png</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="gulp-å¼€å‘æµç¨‹"><a href="#gulp-å¼€å‘æµç¨‹" class="header-anchor">#</a> <em>gulp</em> å¼€å‘æµç¨‹</h3> <p>ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š</p> <p><img src="https://i.loli.net/2019/11/05/yxatp6HzRUAm9G4.png" alt="image-20191105174239088.png"></p> <h4 id="gulp-çš„å„ä¸ªä»»åŠ¡-taskcontroler-js-æ–‡ä»¶"><a href="#gulp-çš„å„ä¸ªä»»åŠ¡-taskcontroler-js-æ–‡ä»¶" class="header-anchor">#</a> <em>gulp</em> çš„å„ä¸ªä»»åŠ¡ï¼šï¼ˆ<em>taskControler.js</em> æ–‡ä»¶ï¼‰</h4> <ul><li><p>æ¯æ¬¡è¿›è¡Œ <em>gulp</em> ä»»åŠ¡å‰éƒ½è¦æ¸…ç©º <em>dist</em> æ‰“åŒ…åçš„ç›®å½•ã€‚ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;clean:dist&quot;</span><span class="token punctuation">,</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(&quot;:::: clean:dist&quot;);</span>

    <span class="token function">src</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">read</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">allowEmpty</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ä½†æ˜¯ï¼Œä¸Šé¢è¿™æ ·å¤„ç†ä¼šæœ‰é—®é¢˜ï¼šç¬¬äºŒæ¬¡è¿è¡Œ <em>gulp</em> å‘½åçš„æ—¶å€™ä¼šæœ‰æ–‡ä»¶æƒé™ç­‰é—®é¢˜ã€‚æ•…ï¼š<em>dist</em> æ–‡ä»¶çš„å¤„ç†é€šè¿‡ <em>nodejs</em> è¿›è¡Œå¤„ç†ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// gulp-clean æ¸…ç©º dist å‘½ä»¤ä¼šæœ‰æƒé™ç­‰ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ•…ï¼šç›´æ¥ç”¨ node è¿›è¡Œåˆ é™¤ dist</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;chalk&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> rimraf <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;rimraf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> distPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">rimraf</span><span class="token punctuation">(</span>distPath<span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">red</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ç„¶ååœ¨ <em>package.json</em> ä¸­é…ç½®è„šæœ¬å‘½ä»¤ï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build:dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node gulpTask/clean.js &amp;&amp; gulp dev --development&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build:prod&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node gulpTask/clean.js &amp;&amp; gulp prod --production&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>è¿™æ ·æ¯æ¬¡æ‰§è¡Œ <em>gulp</em> å‘½ä»¤å‰éƒ½ä¼šåˆ é™¤ <em>dist</em> ç›®å½•ã€‚</p></li> <li><p>å¤„ç† <em>less</em> æ–‡ä»¶ã€‚éœ€è¦è§£å†³çš„é—®é¢˜æœ‰ï¼š</p> <ul><li>å¼€å‘ç¯å¢ƒä¸å‹ç¼©ä»£ç ï¼Œç”Ÿäº§ç¯å¢ƒå‹ç¼©ä»£ç ï¼›</li> <li>è‡ªåŠ¨æ·»åŠ å±æ€§å‰ç¼€ï¼Œ<em>autoperfixer</em>ï¼›</li> <li>å°† <em>less</em> æ–‡ä»¶çš„åç¼€æ›´æ”¹ä¸º <em>wxss</em>ï¼›</li> <li>å°† <em>less</em> æ–‡ä»¶å†…éƒ¨çš„ <em>@import</em> å¼•ç”¨æ–‡ä»¶çš„åç¼€æ›´æ”¹ä¸º <em>wxss</em>ã€‚</li></ul> <p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;compile:less&quot;</span><span class="token punctuation">,</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(&quot;:::: compile:less&quot;);</span>

    <span class="token function">src</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>lessPath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;src&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">changed</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">gulpif</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isDev<span class="token punctuation">,</span> <span class="token function">cleanCss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// .pipe(less({</span>
    <span class="token comment">//   paths: baseConfig.lessImportPath,</span>
    <span class="token comment">//   plugins: [autoprefix]</span>
    <span class="token comment">// }))</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ›´æ”¹ .less æ–‡ä»¶åç¼€ä¸º .wxss</span>
        path<span class="token punctuation">.</span>extname <span class="token operator">=</span> <span class="token string">&quot;.wxss&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;.wxss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ä¿®æ”¹ less æ–‡ä»¶å†…éƒ¨çš„å¼•ç”¨ .less æ–‡ä»¶åç¼€ä¸º .wxss</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿™é‡Œé‡åˆ°ä¸€ä¸ªå‘ï¼Œç”¨ l<em>ess-plugin-autoprefix @import</em> ä¼šæœ‰é—®é¢˜ï¼Œ<em>@import</em> è¯­å¥ä¼šè¢«åˆ é™¤ã€‚åé¢æ”¹ç”¨ <em>gulp-autoprefixer</em>ã€‚</p></li> <li><p>å¤„ç† <em>js</em> æ–‡ä»¶ã€‚éœ€è¦è§£å†³çš„é—®é¢˜æœ‰ï¼š</p> <ul><li><em>eslint</em> ä»£ç æ ¼å¼æ£€æŸ¥ï¼›</li> <li>å¼€å‘ç¯å¢ƒä¸å‹ç¼©ä»£ç ï¼Œç”Ÿäº§ç¯å¢ƒå‹ç¼©ä»£ç ï¼›</li></ul> <p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;compile:js&quot;</span><span class="token punctuation">,</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(&quot;:::: compile:js&quot;);</span>

  <span class="token function">src</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>jsPath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;src&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">changed</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// .pipe(babel({ // å…ˆé€šè¿‡ babel è½¬åŒ–è¯­æ³•ç„¶åæ‰èƒ½è¿›è¡Œå‹ç¼© --&gt; å¾®ä¿¡å¼€å‘è€…å·¥å…·æœ‰ es6 è½¬ es5 åŠŸèƒ½</span>
    <span class="token comment">//   presets: [&quot;@babel/env&quot;]</span>
    <span class="token comment">// }))</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">eslint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// .pipe(eslint.format())</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">gulpif</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isDev<span class="token punctuation">,</span> <span class="token function">uglify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿™é‡ŒåŸæœ¬åŠ äº† <em>babel</em> è¿›è¡Œ <em>es6</em> åˆ° <em>es5</em> çš„è½¬åŒ–ï¼Œä½†æ˜¯å¾®ä¿¡å¼€å‘è€…å·¥å…·æœ¬èº«å°±æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œæ•…å»é™¤ã€‚å¦ä¸€ä¸ªå‘æ˜¯ï¼Œç”¨ <em>gulp-uglify</em> ä¸èƒ½è¿›è¡Œ <em>es6</em> ä»£ç çš„å‹ç¼©ï¼Œè¦ç”¨ <em>gulp-uglify-es</em> ã€‚</p></li> <li><p>å¤„ç† <em>wxml</em> æ–‡ä»¶ã€‚éœ€è¦è§£å†³çš„é—®é¢˜æœ‰ï¼š</p> <ul><li>å¼€å‘ç¯å¢ƒä¸å‹ç¼©ä»£ç ï¼Œç”Ÿäº§ç¯å¢ƒå‹ç¼©ä»£ç ï¼›</li></ul> <p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;compile:wxml&quot;</span><span class="token punctuation">,</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(&quot;:::: compile:wxml&quot;);</span>

  <span class="token function">src</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>wxmlPath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;src&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">changed</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">gulpif</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isDev<span class="token punctuation">,</span> <span class="token function">htmlmin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">collapseWhitespace</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>å¤„ç† <em>json</em> æ–‡ä»¶ã€‚éœ€è¦è§£å†³çš„é—®é¢˜æœ‰ï¼š</p> <ul><li>å¼€å‘ç¯å¢ƒä¸å‹ç¼©ä»£ç ï¼Œç”Ÿäº§ç¯å¢ƒå‹ç¼©ä»£ç ï¼›</li></ul> <p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;compile:json&quot;</span><span class="token punctuation">,</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(&quot;:::: compile:json&quot;);</span>

  <span class="token function">src</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>jsonPath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;src&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">changed</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">gulpif</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isDev<span class="token punctuation">,</span> <span class="token function">prettyData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;minify&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">preserveComments</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;json&quot;</span><span class="token operator">:</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>å…¶ä»–æ‰€æœ‰æ–‡ä»¶ã€‚</p> <p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;compile:other&quot;</span><span class="token punctuation">,</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log(&quot;:::: compile:other&quot;);</span>

      <span class="token function">src</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>otherPath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;src&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">changed</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>å›¾ç‰‡å‹ç¼©ã€‚</p> <p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;minify:image&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(&quot;:::: minify:image&quot;);</span>

  <span class="token function">src</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>imagePath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;src&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">imagemin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>imagemin<span class="token punctuation">.</span><span class="token function">optipng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imagemin<span class="token punctuation">.</span><span class="token function">gifsicle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imagemin<span class="token punctuation">.</span><span class="token function">jpegtran</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>distPath<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>å¼€å‘ç¯å¢ƒå¼€å¯ç›‘æ§ <em>watch</em>ã€‚</p> <p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;watch&quot;</span><span class="token punctuation">,</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(&quot;:::: compile:other&quot;);</span>

  <span class="token function">watch</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>basePath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;src&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">series</span><span class="token punctuation">(</span><span class="token string">&quot;compile:less&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;compile:js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;compile:wxml&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;compile:json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;compile:other&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;minify:image&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>æœ€åï¼Œå°†ä»»åŠ¡è¿›è¡Œ <em>id</em> ç»‘å®šå¤„ç†ï¼Œè¿˜æœ‰ä¸åŒç¯å¢ƒçš„åŒºåˆ†ã€‚ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> <span class="token function">parallel</span><span class="token punctuation">(</span><span class="token string">&quot;compile:less&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;compile:js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;compile:wxml&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;compile:json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;compile:other&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;minify:image&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">task</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">dev-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token function">series</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;watch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">task</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">prod-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token function">series</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h4 id="gulp-å…¥å£æ–‡ä»¶å¤„ç†-gulpfile-js-æ–‡ä»¶"><a href="#gulp-å…¥å£æ–‡ä»¶å¤„ç†-gulpfile-js-æ–‡ä»¶" class="header-anchor">#</a> <em>gulp</em> å…¥å£æ–‡ä»¶å¤„ç†ï¼šï¼ˆ<em>gulpfile.js</em> æ–‡ä»¶ï¼‰</h4> <p>ä¸»è¦æ˜¯å¯¹ä¸åŒç¯å¢ƒçš„åŒºåˆ†ï¼Œè¿˜æœ‰ <em>taskControler.js</em> å®šä¹‰çš„å„ä¸ªä»»åŠ¡è¿›è¡Œå¼•ç”¨ã€‚ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
  task<span class="token punctuation">,</span>
  series
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TaskControler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./gulpTask/taskControler&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// é¡¹ç›® ID</span>
<span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./package.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name <span class="token operator">||</span> <span class="token string">&quot;min-program&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">TaskControler</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*---------- ç›¸å…³çš„ gulp ä»»åŠ¡ ----------*/</span>

<span class="token comment">// dev å¼€å‘ç¯å¢ƒä»»åŠ¡</span>
<span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;dev&quot;</span><span class="token punctuation">,</span> <span class="token function">series</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">dev-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// prod ç”Ÿäº§ç¯å¢ƒä»»åŠ¡</span>
<span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&quot;prod&quot;</span><span class="token punctuation">,</span> <span class="token function">series</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">prod-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ¥ç€ï¼Œåªéœ€è¦æ‰§è¡Œ <code>npm run build:dev</code>æˆ– <code>npm run build:prod</code>ï¼Œç„¶åå°†ç”Ÿæˆçš„ <em>dist</em> ç›®å½•ä¸¢åˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·å³å¯ã€‚</p> <h2 id="è·¯ç”±å°è£…"><a href="#è·¯ç”±å°è£…" class="header-anchor">#</a> è·¯ç”±å°è£…</h2> <ul><li><p>è·¯ç”±è¡¨æ–‡ä»¶</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * è·¯ç”±è·¯å¾„
 */</span>
<span class="token keyword">const</span> routerPath <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token string">&quot;/pages/index/index&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">detail</span><span class="token operator">:</span> <span class="token string">&quot;/pages/detail/detail&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> routerPath<span class="token punctuation">;</span>
</code></pre></div></li> <li><p>è·¯ç”±é€»è¾‘å¤„ç†</p> <p>æœ€åä½¿ç”¨è·¯ç”±çš„æ–¹å¼ä¸ºï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>app<span class="token punctuation">.</span>Router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'detail'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Ertsul'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>éœ€è¦å¤„ç†çš„é—®é¢˜æœ‰ï¼šè·¯ç”±å‚æ•°è½¬åŒ–ä¸ºå°ç¨‹åºçš„æ ¼å¼ã€æœ‰å‚æ— å‚è·¯ç”±ã€‚</p> <p>è·¯ç”±å‚æ•°è½¬åŒ–ä¸ºå°ç¨‹åºçš„æ ¼å¼ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * å¤„ç†è·¯ç”±å‚æ•°ï¼Œæ‹¼æ¥æˆå­—ç¬¦ä¸²å½¢å¼
 * @param {*} queryObj ï¼š è·¯ç”±å‚æ•°
 */</span>
<span class="token keyword">function</span> <span class="token function">dealQuery</span><span class="token punctuation">(</span><span class="token parameter">queryObj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> tempArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> queryObj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>queryObj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> queryObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      tempArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token string">&quot;?&quot;</span> <span class="token operator">+</span> tempArr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å°è£…ä¸€ä¸ªå¯¹è±¡ï¼Œæ·»åŠ  <em>push</em> å¯¹å¤–æš´éœ²çš„æ–¹æ³•ï¼Œæ·»åŠ å†…éƒ¨è·³è½¬çš„æ–¹æ³•ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> Router <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 
   * @param {String} param0 : è·¯å¾„
   * @param {Object} param1 : å‚æ•°
   * @param {String} param2 : ç±»å‹ï¼ŒredirectTo/reLaunch/back/navigateTo
   */</span>
  <span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    path <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    query <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    type <span class="token operator">=</span> <span class="token string">&quot;navigateTo&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// è·å–å¯¹åº”çš„å°ç¨‹åºè·¯å¾„</span>
    <span class="token keyword">let</span> url <span class="token operator">=</span> routerPath<span class="token punctuation">[</span>path<span class="token punctuation">]</span> <span class="token operator">||</span> routerPath<span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// å¤„ç† query </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'[object Object]'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      params <span class="token operator">=</span> <span class="token function">dealQuery</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è·¯ç”±å‚æ•°ç±»å‹é”™è¯¯ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    url <span class="token operator">+=</span> params<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰§è¡Œè·³è½¬</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 
   * @param {*} url : è·¯å¾„ + å‚æ•°
   * @param {*} type : ç±»å‹ï¼ŒredirectTo/reLaunch/back/navigateTo
   */</span>
  <span class="token function">to</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">&quot;redirectTo&quot;</span><span class="token operator">:</span>
        wx<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          url
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;reLaunch&quot;</span><span class="token operator">:</span>
        wx<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          url
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;back&quot;</span><span class="token operator">:</span>
        wx<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">delta</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;navigateTo&quot;</span><span class="token operator">:</span>
        wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          url
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æœ€åå°† <em>Router</em> å¯¹è±¡æŒ‚è½½åˆ° <em>app</em> å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./router/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//app.js</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  Router<span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h2 id="http-å°è£…åŠå…¶æ¥å£ç»Ÿä¸€ç®¡ç†"><a href="#http-å°è£…åŠå…¶æ¥å£ç»Ÿä¸€ç®¡ç†" class="header-anchor">#</a> http å°è£…åŠå…¶æ¥å£ç»Ÿä¸€ç®¡ç†</h2> <p><em>http</em> å°è£…ï¼Œå¯ä»¥æ·»åŠ ä¸€äº›è¯·æ±‚å…¬å…±å‚æ•°ç­‰ã€‚æ ¸å¿ƒä»£ç ä¸ºï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
  data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  method <span class="token operator">=</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
  header <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'content-type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span> <span class="token comment">// é»˜è®¤å€¼</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token punctuation">,</span>
      data<span class="token punctuation">,</span>
      method<span class="token punctuation">,</span>
      header<span class="token punctuation">,</span>
      <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">fail</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ¥å£ç»Ÿä¸€ç®¡ç†ã€‚æ¥å£ç»Ÿä¸€ç®¡ç†æœ‰åˆ©äºåæœŸç»´æŠ¤ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../http/request'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> baseConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../http/baseConfig'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// get ä¾‹å­</span>
<span class="token keyword">const</span> getList <span class="token operator">=</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> baseConfig<span class="token punctuation">.</span>baseUrl <span class="token operator">+</span> <span class="token string">'/list?page=1&amp;size=10'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// post ä¾‹å­</span>
<span class="token keyword">const</span> updateInfo <span class="token operator">=</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> baseConfig<span class="token punctuation">.</span>baseUrl <span class="token operator">+</span> <span class="token string">'/updateInfo'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Ertsul'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  getList<span class="token punctuation">,</span>
  updateInfo
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">12/4/2021, 10:52:49 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/minapp/å°ç¨‹åºæ–‡ä»¶ç”Ÿæˆè„šæœ¬.html">
        å°ç¨‹åºæ–‡ä»¶ç”Ÿæˆè„šæœ¬
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/blog/assets/js/app.6db985fd.js" defer></script><script src="/blog/assets/js/2.9a122aa2.js" defer></script><script src="/blog/assets/js/41.32f10a8a.js" defer></script>
  </body>
</html>
